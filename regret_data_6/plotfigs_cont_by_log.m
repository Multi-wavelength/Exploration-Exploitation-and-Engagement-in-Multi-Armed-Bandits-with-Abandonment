clear;
close all;

num_sims = 1e7;
K=2e4;
markers = {'o','^','x','v','d','*','s','>','<','+'};
colors = {[0, 1, 0], [0, 0, 1], [0, 0.8, 0], [0, 0, 0.8], [0.8, 0, 0]};

regret_ulcb1_mean = load('regret_data_7_-0.707107_0.707107.txt');
regret_ulcb1_mean = regret_ulcb1_mean(1:K).';
regret_ulcb1_std = 1.96 * load('regret_data_std_7_-0.707107_0.707107.txt') / sqrt(num_sims);
regret_ulcb1_std = regret_ulcb1_std(1:K).';
regret_ulcb1_mean_conf = [regret_ulcb1_mean+regret_ulcb1_std regret_ulcb1_mean(end:-1:1)-regret_ulcb1_std(end:-1:1)];

regret_ucb_mean = load('regret_data_9_0.707107_0.707107.txt');
regret_ucb_mean = regret_ucb_mean(1:K).';
regret_ucb_std = 1.96 * load('regret_data_std_9_0.707107_0.707107.txt') / sqrt(num_sims);
regret_ucb_std = regret_ucb_std(1:K).';
regret_ucb_mean_conf = [regret_ucb_mean+regret_ucb_std regret_ucb_mean(end:-1:1)-regret_ucb_std(end:-1:1)];

regret_ulcb2_mean = load('regret_data_10_-0.707107_0.707107.txt');
regret_ulcb2_mean = regret_ulcb2_mean(1:K).';
regret_ulcb2_std = 1.96 * load('regret_data_std_10_-0.707107_0.707107.txt') / sqrt(num_sims);
regret_ulcb2_std = regret_ulcb2_std(1:K).';
regret_ulcb2_mean_conf = [regret_ulcb2_mean + regret_ulcb2_std regret_ulcb2_mean(end:-1:1)-regret_ulcb2_std(end:-1:1)];


regret_kl_ulcb1_mean = load('regret_data_12_1.000000_1.000000.txt');
regret_kl_ulcb1_mean = regret_kl_ulcb1_mean(1:K).';
regret_kl_ulcb1_std = 1.96 * load('regret_data_std_12_1.000000_1.000000.txt') / sqrt(num_sims);
regret_kl_ulcb1_std = regret_kl_ulcb1_std(1:K).';
regret_kl_ulcb1_mean_conf = [regret_kl_ulcb1_mean + regret_kl_ulcb1_std regret_kl_ulcb1_mean(end:-1:1)-regret_kl_ulcb1_std(end:-1:1)];

regret_kl_ucb_mean = load('regret_data_14_1.000000_1.000000.txt');
regret_kl_ucb_mean = regret_kl_ucb_mean(1:K).';
regret_kl_ucb_std = 1.96 * load('regret_data_std_14_1.000000_1.000000.txt') / sqrt(num_sims);
regret_kl_ucb_std = regret_kl_ucb_std(1:K).';
regret_kl_ucb_mean_conf = [regret_kl_ucb_mean+regret_kl_ucb_std regret_kl_ucb_mean(end:-1:1)-regret_kl_ucb_std(end:-1:1)];

regret_kl_ulcb2_mean = load('regret_data_15_1.000000_1.000000.txt');
regret_kl_ulcb2_mean = regret_kl_ulcb2_mean(1:K).';
regret_kl_ulcb2_std = 1.96 * load('regret_data_std_15_1.000000_1.000000.txt') / sqrt(num_sims);
regret_kl_ulcb2_std = regret_kl_ulcb2_std(1:K).';
regret_kl_ulcb2_mean_conf = [regret_kl_ulcb2_mean + regret_kl_ulcb2_std regret_kl_ulcb2_mean(end:-1:1)-regret_kl_ulcb2_std(end:-1:1)];

figure;
ylim([0,12])
xlim([2,K])
hold on;
grid on;
xlabel('K episodes (log scale)');
% ylabel('$E[\mathrm{Reg}_{\pi}(K)]$', 'interpreter', 'latex');
ylabel('Average total regret / log(K)');
set(gca, 'FontSize', 14);

set(gca, 'XScale', 'log')
set(gca, 'XTick', [1, 1e1, 1e2, 1e3, 1e4]);
set(gca, 'YTick', 0:2:12);

num_points = 1e2;
x = unique(round(logspace(log10(2),log10(K),num_points)));
xconf = [x x(end:-1:1)];

% p1 = fill(xconf,regret_ucb_mean_conf,'red');
% p1.FaceColor = [1 0.6 0.6];
% p1.EdgeColor = 'none';
% p1.Annotation.LegendInformation.IconDisplayStyle = 'off';
% 
% p2 = fill(xconf,regret_kl_ucb_mean_conf,'magenta');
% p2.FaceColor = [1 0.6 1];
% p2.EdgeColor = 'none';
% p2.Annotation.LegendInformation.IconDisplayStyle = 'off';
% 
% p3 = fill(xconf,regret_ulcb_mean_conf,'green');
% p3.FaceColor = [0.6 1 0.6];
% p3.EdgeColor = 'none';
% p3.Annotation.LegendInformation.IconDisplayStyle = 'off';
% 
% p4 = fill(xconf,regret_kl_ulcb_mean_conf,'blue');
% p4.FaceColor = [0.6 0.6 1];
% p4.EdgeColor = 'none';
% p4.Annotation.LegendInformation.IconDisplayStyle = 'off';


% semilogx(x, regret_ucb_mean(x)./log(x), 'color', colors{3}, 'linestyle', ':', 'linewidth', 1.5, 'Marker', markers{1}, 'MarkerIndices', 1:10:length(x));
semilogx(x, regret_ulcb1_mean(x)./log(x), 'color', colors{3}, 'linestyle', '-.', 'linewidth', 1.5, 'Marker', markers{1}, 'MarkerIndices', 1:10:length(x));
semilogx(x, regret_ulcb2_mean(x)./log(x), 'color', colors{3}, 'linestyle', '-', 'linewidth', 1.5, 'Marker', markers{1}, 'MarkerIndices', 1:10:length(x));
semilogx(x, 6.3799*log(x)./log(x), 'color', colors{3}, 'linestyle', '--', 'linewidth', 1.5, 'Marker', markers{1}, 'MarkerIndices', 1:10:length(x));

% semilogx(x, regret_kl_ucb_mean(x)./log(x), 'color', colors{4}, 'linestyle', ':', 'linewidth', 1.5, 'Marker', markers{2}, 'MarkerIndices', 1:10:length(x));
semilogx(x, regret_kl_ulcb1_mean(x)./log(x), 'color', colors{4}, 'linestyle', '-.', 'linewidth', 1.5, 'Marker', markers{2}, 'MarkerIndices', 1:10:length(x));
semilogx(x, regret_kl_ulcb2_mean(x)./log(x), 'color', colors{4}, 'linestyle', '-', 'linewidth', 1.5, 'Marker', markers{2}, 'MarkerIndices', 1:10:length(x));
semilogx(x, 3.4777*log(x)./log(x), 'color', colors{4}, 'linestyle', '--', 'linewidth', 1.5, 'Marker', markers{2}, 'MarkerIndices', 1:10:length(x));

semilogx(x, 3.4069*log(x)./log(x), 'color', colors{5}, 'linestyle', '--', 'linewidth', 1.5, 'Marker', markers{3}, 'MarkerIndices', 1:10:length(x));


legend('DISC-ULCB', 'CONT-ULCB', 'UB for DISC-ULCB', 'DISC-KL-ULCB', 'CONT-KL-ULCB',... 
       'UB for DISC-KL-ULCB', 'LB for MAB-A');
