clear;
close all;
clc;
mu1 = 0.2;  % or 0.9
nmax = 1e6;
eps = 1e-10;
size_v = 1e7;
V = zeros(size_v,1);
unit_idx = (1:size_v).';
unit_value = (1:size_v).'/size_v;
c = 1000;
for k=1:nmax
    V_new = mu1+(1-mu1)/log(c+1)*log(1+c*unit_value/2).*V(round(unit_idx/2))+mu1/log(c+1)*log(1+c*(unit_value+1)/2).*V(round((unit_value+1)/2*size_v));
    if sum(V_new-V)<eps
        V = V_new;
        break;
    end
    V = V_new;
    if mod(k,round(nmax/10000))==0
        disp(k/nmax);
    end
end

save("cont_V_c_" + num2str(c) + "_" + num2str(mu1) + ".mat", 'V')

